x<-c(55,56,57)
x
q_x<-c(0.001046,0.001199,0.001375)
q_x
p_x<-1-q_x
p_x
tp_x<-c(p_x[1],p_x[1]*p_x[2],p_x[1]*p_x[2]*p_x[3])
tp_x
init_exp<-100+0.015*40250
init_exp
t<-c(0,1,2);inf<-0.05
annuity_exp<-10*(1+inf)^t
annuity_exp
payment_compound_rate<-0.0192308
t<-c(0,1,2)
payment<-15000*(1+payment_compound_rate)^t
payment
j<-(1+0.06)/(1+0.0192308)-1
j
v<-1/(1+j)
d<-1-v
A<-c(0.889132,0.924607)
policy_EOY<-c(payment[1:2]*(v-A)/d,0)
policy_EOY
Exp_prem<-c(40250,0,0)
Exp_prem
E_exp<-c(init_exp,0,0)
E_exp
E_annuity_exp<-annuity_exp*tp_x
E_annuity_exp
E_annuity_payment<-payment*tp_x
E_annuity_payment
E_policy_EOY<-policy_EOY*tp_x
E_policy_EOY
E_j<-c(0.08*(Exp_prem[1]-E_exp[1]),0.08*(Exp_prem[2:3]+E_policy_EOY[1:2]-E_exp[2:3]))
E_j
transfer<-c()
transfer[1]<-Exp_prem[1]-E_exp[1]-E_annuity_exp[1]-E_annuity_payment[1]+E_j[1]-E_policy_EOY[1]
transfer[2:3]<-E_policy_EOY[1:2]-E_annuity_exp[2:3]-E_annuity_payment[2:3]+E_j[2:3]-E_policy_EOY[2:3]
transfer
t_1<-c(1,2,3)
EPV_transfer<-sum(1.12^(-t_1)*transfer)
EPV_transfer
Profit_margin<-EPV_transfer/Exp_prem[1]
Profit_margin
IRR<-function(R){sum((1+R)^(-t_1)*transfer)}
uniroot(IRR,c(0.4,0.6))